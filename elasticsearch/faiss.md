# 사전지식

- 단어 집합(vocabulary, 혹은 사전)
  - 서로 다른 단어들의 집합
  - 단어 집합에서는 기본적으로 book과 books와 같이 단어의 변형 형태도 서로 다른 단어로 간주한다.



- 말뭉치(corpus)
  - 자연어 연구를 위해 특정한 목적을 가지고 언어의 표본을 추출한 집합.



- 원-핫 인코딩(One-Hot Encoding)

  - 자연어 처리에서 문자를 숫자로 바꾸는 여러 기법 중 하나
    - 컴퓨터는 문자보다는 숫자를 더 잘 처리하기에 자연어 처리를 할 때에는 문자를 숫자로 변경해준다.
  - 단어 집합(vocabulary, 혹은 사전)
    - 서로 다른 단어들의 집합
    - 단어 집합에서는 기본적으로 book과 books와 같이 단어의 변형 형태도 서로 다른 단어로 간주한다.
    - 텍스트의 모든 단어를 중복을 허용하지 않고 모아놓으면 이를 단어 집합이라 할 수 있다.
  - 단어 집합의 크기를 벡터의 차원으로 표현하고, 표현하고 싶은 단어의 인덱스에 1의 값을 부여하고 다른 인덱스에는 0을 부여하는 단어의 벡터 표현 방식이다.
    - 이렇게 표현된 벡터를 원-핫 벡터라 부른다.
  - 크게 두 단계를 거친다.
    - 각 단어에 고유한 인덱스를 부여한다(정수 인코딩).
    - 표현하고 싶은 단어의 인덱스의 위치에 1을 부여하고, 다른 단어의 인덱스의 위치에는 0을 부여한다.

  - 예시

  ```python
  # 텍스트
  text = '나는 밥을 먹는다.'
  
  # 토큰화
  ['나', '는', '밥', '을', '먹는다']
  
  # 각 단어에 인덱스 부여
  {'나': 0, '는': 1, '밥': 2, '을': 3, '먹는다': 4}
  
  # 원-핫 인코딩을 활용하여 벡터화
  # 각 단어의 인덱스에 해당하는 값만 1이 되고 나머지는 모두 0이 된다.
  [[1,0,0,0,0],	# 나
  [0,1,0,0,0],	# 는
  [0,0,1,0,0],	# 밥
  [0,0,0,1,0],	# 을
  [0,0,0,0,1]]	# 먹는다
  ```

  - 한계
    - 단어의 개수가 늘어날 수록, 벡터를 저장하기 위해 필요한 공간(벡터의 차원)이 계속 늘어난다.
    - 단어 집합의 크기가 곧 벡터의 차원 수가 된다.
    - 만일 단어가 1000개인 코퍼스를 가지고 원 핫 벡터를 만들면, 모든 단어 각각은 모두 1,000 개의 차원을 가진 벡터가 된다.
    - 다시 말해 모든 단어 각각은 하나의 값만 1을 가지고, 999개의 값은 0의 값을 가지는 벡터가 되는데 이는 저장 공간 측면에서 매우 비효율적인 표현 방법이다.
    - 또한 단어의 유사도를 표현하지 못한다는 단점이 존재한다.



- 워드 임베딩
  - 희소 표현(Sparse representation)
    - 원-핫 인코딩을 통해 나온 원-핫 벡터들과 같이 벡터 또는 행렬의 값이 대부분 0으로 표현되는 방법을 희소표현이라 한다.
    - 희소 표현 방식으로 표현한 벡터를 희소 벡터라 한다.
  - 밀집 표현(Dense representation)
    - 희소 표현의 반대 개념으로 벡터의 차원을 단어 집합의 크기로 상정하지 않는다.
    - 사용자가 설정한 값으로 모든 단어의 벡터 표현의 차원을 맞춘다.
    - 이 과정에서 더 이상 0과 1만 가진 값이 아닌 실수값을 가지게 된다.
    - 예를 들어 단어가 1000 개인 코퍼스에서 강아지라는 단어를 희소표현으로는 [1,0,0,0, 996개의 0]과 같이 표현한다면,
    - 밀집 표현에서는 사용자가 차원을 4로 설정했다면 [0.2, 1.8, 1.1, -2.1]과 같이 표현된다.
  - 단어를 밀집 벡터의 형태로 표현하는 방법을 워드 임베딩이라 한다.
    - 밀집 벡터를 워드 임베딩 과정을 통해 나온 결과라고 하여 임베딩 벡터라고도 부른다.



# faiss 개요

- faiss
  - 효율적인 유사도 검색과 밀집 벡터(dense vectors)의 클러스터링(clustering)을 위한 라이브러리
    - 클러스터링: 데이터를 데이터 간의 유사도에 따라 k개의 그룹으로 나누는 것.

