

# 추천 시스템

> https://www.youtube.com/watch?v=_YndKkun2Sw 참고
>
> https://lsjsj92.tistory.com/568 참고

- 프로젝트에 위 사이트를 참고하여 짠 user, item based 코드가 있으므로 추후에 작성할 것

## Collaborative filtering

- 대표적인 추천 알고리즘



### User based Collaborative filtering

- 과정

  - 어떤 유저들이 유사한지를 판단한다.
  - 어떤 유저가 어떤 영화를 고평가 했다면 1, 고평가하지 않았다면 0을 줘서 아래 표와 같이 vector로 표현한다.

  |      | 어벤져스 | 존윅 | 인터스텔라 | 어바웃 타임 | 러브레터 |
  | ---- | -------- | ---- | ---------- | ----------- | -------- |
  | A    | 1        | 1    | 1          | 0           | 0        |
  | B    | 0        | 0    | 0          | 1           | 1        |
  | C    | 1        | 1    | 0          | 0           | 0        |
  | D    | 0        | 0    | 0          | 0           | 1        |

  - 유저들 사이의 유사성을 계산한다.
    - 계산 방법 중 하나인 `Cosine similarity`로 A,C의 유사도를 계산하면 다음과 같다.
    - A,C 둘 다 고평가한 영화는 2개이므로 분자에는 2가 간다.
    - Cosine similarity = 2/sqrt(3)*sqrt(2)=0.81
    - 마찬가지 방식으로 B와 C, D와 C의 유사도를 계산하면 둘 다 0이 나온다.
    - 따라서 A가 C와 가장 유사도가 높은 유저라고 할 수 있다.
  - 유사도에 기반해서 다른 유저에게 영화를 추천해준다.
    - C 유저는 A 유저와 유사도가 가장 높으므로 A 유저가 고평가했지만 C 유저는 보지 않은 인터스텔라를 C에게 추천해준다.



### Item based Collaborative filtering

- 과정

  - User based Collaborative filtering과 마찬가지로 유저 정보와 영화 정보를 vector화 해서 표현한다.

    |            | A    | B    | C    | D    |
    | ---------- | ---- | ---- | ---- | ---- |
    | 어벤져스   | 1    | 0    | 1    | 0    |
    | 존윅       | 1    | 0    | 1    | 0    |
    | 인터스텔라 | 1    | 0    | 0    | 0    |
    | 어바웃타임 | 0    | 1    | 0    | 0    |
    | 러브레터   | 0    | 1    | 0    | 1    |

  - 영화의 유사성을 계산한다.

    - 역시  `Cosine similarity`로 어바웃 타임과 러브레터의 유사도를 계산하면 다음과 같다.
    - 러브레터는 B와 D에게 높은 평가를 받았다.
    - 어바웃 타임은 B에게만 높은 평가를 받았다.
    - 이 때  `Cosine similarity`로 어바웃 타임과 러브레터의 유사도를 비교해보면 0.71이 나온다.
    - B는 어벤져스, 존윅, 인터스텔라에는 높은 평가를 하지 않았다.
    - 마찬가지 방식으로 러브레터와 어번제스, 존윅 , 인터스텔라의 유사도를 계산하면 모두 0이 나온다.
    - 따라서 어바웃 타임이 러브레터와 가장 유사도가 높은 영화라고 할 수 있다.

  - 영화의 유사도에 기반해서 D에게 어바웃 타임을 추천해준다.

    - D가 높게 평가한 러브레터와 유사도가 가장 높지만 아직 D가 보지 않은 어바웃 타임을 추천해준다.





## Content based filtering

- Collaborative filtering의 경우 `cold start problem`이 존재
  - cold start problem: Collaborative filtering은 모두 유저의 평가를 기반으로 추천이 이루어지는데 새로운 영화가 나온 경우 해당 영화에 대한 유저의 평가가 존재하지 않으므로 해당 영화는 추천 할 수 없다. 이와 같이 새롭게 출시된 제품의 평가가 존재하지 않아 새로운 제품의 추천이 이루어지지 않는 문제를 cold start problem라고 부른다. 
  - Content based filtering는 cold start problem가 발생하지 않는다.



- 각 영화별로 특성을 정의한다.

  - 각 영화가 특정 특성을 지니고 있으면 1, 없으면 0으로 표시하여 vector화 한다.

  |            | SF   | 로맨스 | 영국인 배우 | 액션 | 크리스토퍼 놀란 감독 |
  | ---------- | ---- | ------ | ----------- | ---- | -------------------- |
  | 어벤져스   | 1    | 0      | 1           | 1    | 0                    |
  | 존윅       | 0    | 0      | 1           | 1    | 0                    |
  | 인터스텔라 | 1    | 0      | 0           | 0    | 1                    |
  | 어바웃타임 | 0    | 1      | 1           | 0    | 0                    |
  | 러브레터   | 0    | 1      | 0           | 0    | 0                    |

  - 이후 기존 영화는 Collaborative filtering과 같이 특성을 기반으로 유사성을 판단하여 유저에게 추천을 해준다.
    - 예를 들어 A는 어벤져스에 고평가를 했다고 했을 때
    - 어벤져스와 영국인 배우, 액션이라는 공통점을 가진 존윅을 추천해준다.
  - 새로 개봉한 영화의 경우도 마찬가지로 새로 개봉한 영화의 특성을 정의하고 이를 백터화 하여 기존 영화들과의 유사성을 판단하여 추천해준다.
    - 예를 들어 A는 어벤져스에 고평가를 했다고 했을 때
    - SF 장르에, 영국인 배우가 출연하는 마션이라는 영화가 개봉을 했다면, 마션은 A가 고평가한 어벤져스와 특성을 기반으로 계산한 유사도가 높을 것이므로 A에게 마션을 추천해준다.



# 통계

- Linear Regression(선형 회귀): 종속변수 y와 한 개 이상의 독립변수 x와의 선형 상관 관계를 모델링 하는 회귀 분석 기법이다.
- Gradient descent
- 예측 과정
  - 임의 값 weight, bias 생성
  - error 값들을 구한다
  - MSE(mean square error)의 미분 결과*learning_rate를 구한다.
  - 3번 결과 값을 weight, bias에 반영한다.
  - MSE(Cost,Loss)가 최소값에 가까워 질 때까지 2~4번을 반복한다.
  - 최적의 weight, bias를 가지고 predict 한다. 